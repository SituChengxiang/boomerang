# 这头昏脑涨的几天

## 老的物理模型——第一次模拟程序尝试
2026/01/26  

还是催一下自己吧。从晚上开始到2.1，能搞出点明堂吗


## 方向真的错了吗 —— 第二版物理模型
2026/01/27，28

卧槽，等等，输入的数据能量不守恒？

## 还是不要garbage in了？
2026/01/29  

重构项目结构+好了改一下滤波的算法

## 这下输入数据应该没啥问题了
2026/01/30

终于调好了

## 反推数据终于好一点了
2026/01/31

喜报 Cl和Cd终于没有暴涨了

## 第三次拟合程序构建
2026/02/01 

主要问题不在“参数没调好”，而在建模的自由度/变量选错了：你现在在用一个标量 φ 去“直接转动升力方向（或等价地让法向 n 围绕速度 v 转）”，但从第一性原理出发，力矩改变的是角动量向量 $\mathbf L$（也就是自转轴/刚体姿态），升力方向只是姿态 + 来流共同决定的“派生量”。把两者混成一个 φ，会在转向、面面角演化上必然出错（尤其你强调的“面面角先增大再减小”基本不可能自然出现）。

更具体地说：

- 进动方程用错对象：应当满足 $\dot{\mathbf L}=\boldsymbol\tau$，其中 $\mathbf L=I_z\,\omega\,\mathbf s$（$\mathbf s$ 为自转轴单位向量）。因此应积分的是 $\mathbf s$（或姿态），而不是把 $\Omega$ 直接塞成某个“绕 $\hat{\mathbf v}$ 的转角速度”。
- 你有了 $|\Omega|=\tau/(I\omega)$ 的标量，还缺最关键的“方向”：需要一个**力矩向量** $\boldsymbol\tau$（方向由几何/来流/升力分布决定），否则 $\mathbf s$ 往哪里进动只能靠猜；而“猜成绕速度转”通常会把航向角符号/曲率搞反或搞单调。
- 约束 n ⟂ v 的位置不对：$\mathbf F_L\perp\mathbf v$ 是对的，但“刚体法向/自转轴”不必然始终与 $\mathbf v$ 正交。正确结构应该是：先由姿态得到自转轴/机体法向 $\mathbf s$，再用投影得到升力方向 $\hat{\mathbf l}=\mathrm{norm}(\mathbf s-(\mathbf s\cdot\hat{\mathbf v})\hat{\mathbf v})$；你现在相当于把 $\hat{\mathbf l}$ 当状态量在转。

次要但会放大误差的点（在修正上述结构后再处理更划算）：
- 用 inverse solve 的常数 Cl/Cd 直接前推，会把强非定常段（尤其 knife-edge 段 Cd→0、Cl/Cd 随姿态/迎角变化）平均掉，导致高度/射程/转向强度系统性偏差。
- 用 $v_{eff}^2=v^2+(\sigma\omega a)^2$ 代替叶片积分是粗糙近似，会影响力和力矩的比例关系（也就影响你拟合出来的 D 的意义）。

如果你愿意我下一步直接动手改，optimizeParams.py 可以把状态改成自转轴 $\mathbf s$（3 维）+ 速度位置（6 维），用 $\dot{\mathbf s}=(\boldsymbol\tau-(\boldsymbol\tau\cdot\mathbf s)\mathbf s)/(I\omega)$，并把升力方向从 $\mathbf s$ 投影得到；这样“转向”和“面面角先增后减”才有物理空间出现。